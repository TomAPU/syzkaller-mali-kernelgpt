# Copyright 2024 syzkaller project authors. All rights reserved.
# Use of this source code is governed by Apache 2 LICENSE that can be found in the LICENSE file.

# Generated on android14-gs-pixel-5.15-udc-d1
# CSF and non-csf builds have overlapping definitions. Must define
# "MALI_USE_CSF" during generation.
meta noextract

include <gpu/common/include/uapi/gpu/arm/midgard/mali_kbase_hwcnt_reader.h>
include <gpu/common/include/uapi/gpu/arm/midgard/mali_base_kernel.h>
include <gpu/common/include/uapi/gpu/arm/midgard/mali_kbase_ioctl.h>
include <gpu/mali_kbase/mali_kbase.h>
include <uapi/linux/fcntl.h>

# Mali
resource fd_mali[fd]

syz_open_dev$KGPT_mali(dev ptr[in, string["/dev/mali#"]], id const[0], flags flags[open_flags]) fd_mali

ioctl$KGPT_KBASE_IOCTL_VERSION_CHECK_RESERVED(fd fd_mali, cmd const[KBASE_IOCTL_VERSION_CHECK_RESERVED], arg ptr[inout, kbase_ioctl_version_check])
ioctl$KGPT_KBASE_IOCTL_KINSTR_PRFCNT_ENUM_INFO(fd fd_mali, cmd const[KBASE_IOCTL_KINSTR_PRFCNT_ENUM_INFO], arg ptr[inout, kbase_ioctl_kinstr_prfcnt_enum_info])
ioctl$KGPT_KBASE_IOCTL_KINSTR_PRFCNT_SETUP(fd fd_mali, cmd const[KBASE_IOCTL_KINSTR_PRFCNT_SETUP], arg ptr[inout, kbase_ioctl_kinstr_prfcnt_setup])
ioctl$KGPT_KBASE_IOCTL_CONTEXT_PRIORITY_CHECK(fd fd_mali, cmd const[KBASE_IOCTL_CONTEXT_PRIORITY_CHECK], arg ptr[inout, kbase_ioctl_context_priority_check])
ioctl$KGPT_KBASE_IOCTL_SET_LIMITED_CORE_COUNT(fd fd_mali, cmd const[KBASE_IOCTL_SET_LIMITED_CORE_COUNT], arg ptr[in, kbase_ioctl_set_limited_core_count])

kbase_ioctl_kinstr_prfcnt_enum_info {
	info_item_size	int32
	info_item_count	int32
	info_list_ptr	intptr
}

kbase_ioctl_kinstr_prfcnt_setup [
	in	kbase_ioctl_kinstr_prfcnt_setup_in
	out	kbase_ioctl_kinstr_prfcnt_setup_out
]

kbase_ioctl_kinstr_prfcnt_setup_in {
	request_item_count	int32
	request_item_size	int32
	requests_ptr		intptr
}

kbase_ioctl_kinstr_prfcnt_setup_out {
	prfcnt_metadata_item_size	int32
	prfcnt_mmap_size_bytes		int32
}

kbase_ioctl_context_priority_check {
	priority	int8
}

kbase_ioctl_set_limited_core_count {
	max_core_count	int8
}
